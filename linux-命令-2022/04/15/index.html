<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="关于等保 2.0 Linux 服务器测评的命令"><title>Linux 命令 - 2022/04/15</title><link rel=canonical href=https://bornfor.fun/linux-%E5%91%BD%E4%BB%A4-2022/04/15/><link rel=stylesheet href=/scss/style.min.fe253589db5a54c99fe6b16bfbaf0243d856d34f8c07f3534613b39ed043b738.css><meta property="og:title" content="Linux 命令 - 2022/04/15"><meta property="og:description" content="关于等保 2.0 Linux 服务器测评的命令"><meta property="og:url" content="https://bornfor.fun/linux-%E5%91%BD%E4%BB%A4-2022/04/15/"><meta property="og:site_name" content="Rainbow"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="Linux"><meta property="article:tag" content="测评"><meta property="article:tag" content="命令"><meta property="article:published_time" content="2022-04-17T11:46:22+08:00"><meta property="article:modified_time" content="2022-08-07T16:37:56+08:00"><meta name=twitter:title content="Linux 命令 - 2022/04/15"><meta name=twitter:description content="关于等保 2.0 Linux 服务器测评的命令"></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=切换菜单>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/avatar_hu020c4d79bfe4d0f1bbff481c7225197f_41176_300x0_resize_q75_h2_box_2.webp width=300 height=300 class=site-logo loading=lazy alt=Avatar></a>
<span class=emoji>🌈</span></figure><div class=site-meta><h1 class=site-name><a href=/>Rainbow</a></h1><h2 class=site-description>披星戴月走过的路，总会繁花满地。</h2></div></header><ol class=social-menu><li><a href=mailto:1295995717@qq.com target=_blank title=1295995717@qq.com><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-messages" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M21 14l-3-3h-7a1 1 0 01-1-1V4a1 1 0 011-1h9a1 1 0 011 1v10"/><path d="M14 15v2a1 1 0 01-1 1H6l-3 3V11a1 1 0 011-1h2"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>小小家</span></a></li><li><a href=/pics/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-infinity" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M9.828 9.172a4 4 0 100 5.656A10 10 0 0012 12a10 10 0 012.172-2.828 4 4 0 110 5.656A10 10 0 0112 12 10 10 0 009.828 9.172"/></svg><span>照骗墙</span></a></li><li><a href=/about/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>碎碎念</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>归归档</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>搜搜看</span></a></li><li><a href=/links/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg><span>友友们</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>暗色模式</span></li></div></ol></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/study/ style=background-color:#2a9d8f;color:#fff>学习</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/linux-%E5%91%BD%E4%BB%A4-2022/04/15/>Linux 命令 - 2022/04/15</a></h2><h3 class=article-subtitle>关于等保 2.0 Linux 服务器测评的命令</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Apr 17, 2022</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>阅读时长: 5 分钟</time></div></footer></div></header><section class=article-content><p>CentOS 7.5 测评命令</p><h2 id=测评命令汇总>测评命令汇总</h2><blockquote><p>more 和 cat 的异同点：两者都是查看文件内容的命令，但 more 命令只支持一页一页的阅读，同时也需要用户手动退出查看模式，cat 命令查看完毕后则会自动返回正常模式。</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>lscpu     <span class=c1># 查看是否为虚拟机</span>
</span></span><span class=line><span class=cl>cat /etc/redhat-release     <span class=c1># 查看 CentOS 版本</span>
</span></span><span class=line><span class=cl>ifconfig     <span class=c1># 查看 IP 地址</span>
</span></span><span class=line><span class=cl>ps -ef <span class=p>|</span> grep nginx     <span class=c1># 查看当前系统中是否包含 nginx 中间件（同理，可查看 apache、weblogic、tomcat 等）</span>
</span></span><span class=line><span class=cl>cat /etc/shadow     <span class=c1># 查看用户名和密码的详细信息（只有拥有 root 权限才可访问）</span>
</span></span><span class=line><span class=cl>cat /etc/passwd     <span class=c1># 查看用户名、UID 和 GID 信息（用户名信息同 /etc/shadow 文件中用户名信息）</span>
</span></span><span class=line><span class=cl>cat /etc/login.defs     <span class=c1># 查看密码长度和密码定期更换规则</span>
</span></span><span class=line><span class=cl>cat /etc/pam.d/system-auth     <span class=c1># 或 /etc/pam.d/login 查看是否配置本地失败处理功能</span>
</span></span><span class=line><span class=cl>cat /etc/profile     <span class=c1># 此文件可以修改环境变量，在等保测评中我们只需查看是否具有超时自动退出策略（例：TMOUT=300）</span>
</span></span><span class=line><span class=cl>cat /etc/ssh/sshd_config <span class=p>|</span> grep -i PermitRootLogin     <span class=c1># 查看是否限制 root 账户访问权限</span>
</span></span><span class=line><span class=cl>sestatus     <span class=c1># 查看 SELinux 当前状态</span>
</span></span><span class=line><span class=cl>service rsyslog status     <span class=c1># 查看系统日志服务运行状态，高版本请使用：systemctl status rsyslog</span>
</span></span><span class=line><span class=cl>service auditd status     <span class=c1># 查看操作审计服务运行状态，高版本请使用：systemctl status auditd</span>
</span></span><span class=line><span class=cl>auditctl -s     <span class=c1># 查看内核状态是否为 1</span>
</span></span><span class=line><span class=cl>auditctl -l     <span class=c1># 查看审计规则</span>
</span></span><span class=line><span class=cl>cat /etc/rsyslog.conf     <span class=c1># 查看日志配置</span>
</span></span><span class=line><span class=cl>ls -l /var/log     <span class=c1># 查看日志权限</span>
</span></span><span class=line><span class=cl>rpm -qa     <span class=c1># 查看当前系统中已安装的软件包</span>
</span></span><span class=line><span class=cl>yum list installed     <span class=c1># 查看当前系统中已安装的软件包</span>
</span></span><span class=line><span class=cl>yum list     <span class=c1># 查看当前系统中可安装的软件包</span>
</span></span><span class=line><span class=cl>systemctl list-units <span class=p>|</span> grep running     <span class=c1># 或 systemctl list-unit-files 查看当前系统中运行的服务，仅查看 enable 的服务请使用：systemctl list-unit-files | grep enable</span>
</span></span><span class=line><span class=cl>netstat -an     <span class=c1># 查看当前系统开启的端口</span>
</span></span><span class=line><span class=cl>rpm -qi samba     <span class=c1># 查看当前系统是否安装了 samba（Linux 系统自身不存在默认共享，创建共享文件夹需安装 samba，安装了就存在默认共享）</span>
</span></span><span class=line><span class=cl>cat /etc/hosts.allow     <span class=c1># 查看可以访问本机的 IP 地址（允许名单）</span>
</span></span><span class=line><span class=cl>cat /etc/hosts.deny     <span class=c1># 查看禁止访问本机的 IP 地址（拒绝名单）</span>
</span></span><span class=line><span class=cl>rpm -qa grep patch     <span class=c1># 查看补丁的更新情况</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=lscpu>lscpu</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Hypervisor vendor:     VMware     # 当前服务器为虚拟机
</span></span></code></pre></td></tr></table></div></div><h2 id=etcredhat-release>/etc/redhat-release</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>CentOS Linux release 7.5.1804 (Core)     # CentOS 版本
</span></span></code></pre></td></tr></table></div></div><h2 id=ifconfig>ifconfig</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>inet 10.10.11.181     # 若当前系统有两个或两个以上网卡，通常看 ens192 网卡的 IP 地址
</span></span></code></pre></td></tr></table></div></div><h2 id=ps--ef--grep-nginx>ps -ef | grep nginx</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>root 620 1 0 2021 ?  00:00:00 nginx: master process /usr/local/nginx/sbin/nginx     # master 进程中列出了nginx的主配置文件
</span></span></code></pre></td></tr></table></div></div><h2 id=etcshadow>/etc/shadow</h2><div class=table-wrapper><table><thead><tr><th style=text-align:center>/</th><th style=text-align:center>用户</th><th style=text-align:center>密码</th><th style=text-align:center>改密时间</th><th style=text-align:center>改密间隔最短时间</th><th style=text-align:center>改密间隔最长时间</th><th style=text-align:center>提前几天警告口令过期</th><th style=text-align:center>口令过期几天后禁用此用户</th><th style=text-align:center>用户过期日期</th></tr></thead><tbody><tr><td style=text-align:center>系统默认</td><td style=text-align:center>root</td><td style=text-align:center>$6$w/UIi</td><td style=text-align:center></td><td style=text-align:center>0</td><td style=text-align:center>99999</td><td style=text-align:center>7</td><td style=text-align:center></td><td></td></tr><tr><td style=text-align:center>等保要求</td><td style=text-align:center>重命名</td><td style=text-align:center>至少为 8 位</td><td style=text-align:center>/</td><td style=text-align:center>不为 0</td><td style=text-align:center>最多 90</td><td style=text-align:center>7</td><td style=text-align:center></td><td></td></tr></tbody></table></div><h2 id=etcpasswd>/etc/passwd</h2><div class=table-wrapper><table><thead><tr><th style=text-align:center>/</th><th style=text-align:center>login_name</th><th style=text-align:center>passwd</th><th style=text-align:center>UID</th><th style=text-align:center>GID</th><th style=text-align:center>user_name</th><th style=text-align:center>用户主目录home_directory</th><th style=text-align:center>shell</th></tr></thead><tbody><tr><td style=text-align:center>系统默认</td><td style=text-align:center>root</td><td style=text-align:center>x</td><td style=text-align:center>0</td><td style=text-align:center>0</td><td style=text-align:center>root</td><td style=text-align:center>/root</td><td style=text-align:center>/bin/bash</td></tr></tbody></table></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>/bin/bash     # 用户正常登录系统（账户正常使用）
</span></span><span class=line><span class=cl>/bin/false     # 是最严格的禁止 login 选项，一切服务都不能用，用户无法登录并且不会有任何提示
</span></span><span class=line><span class=cl>/sbin/nologin     # nologin 会向用户显示一条信息，并拒绝用户登录系统：This account is currently not available.
</span></span></code></pre></td></tr></table></div></div><p>  现在的 Unix/Linux 系统中，口令不再保存在 /etc/passwd 文件中，通常将 /etc/passwd 文件中的口令字段使用一个“x”来代替，将 /etc/shadow 文件作为真正的口令存放文件，用于保存包括个人口令在内的数据。只有超管用户才有权读取 shadow 文件。</p><p>  此外，若 /etc/passwd 字段中的第一个字符是“*”的话，就表示系统不允许持有该账号的用户登录。</p><h2 id=etclogindefs>/etc/login.defs</h2><div class=table-wrapper><table><thead><tr><th style=text-align:center>/</th><th style=text-align:center>PASS_MAX_DAYS</th><th style=text-align:center>PASS_MIN_DAYS</th><th style=text-align:center>PASS_MIN_LEN</th><th style=text-align:center>PASS_WARN_AGE</th></tr></thead><tbody><tr><td style=text-align:center>字段含义</td><td style=text-align:center>登录密码有效期</td><td style=text-align:center>改密间隔最短时间</td><td style=text-align:center>密码最小长度</td><td style=text-align:center>提前几天警告口令过期</td></tr><tr><td style=text-align:center>系统默认</td><td style=text-align:center>99999</td><td style=text-align:center>0</td><td style=text-align:center>5</td><td style=text-align:center>7</td></tr><tr><td style=text-align:center>等保要求</td><td style=text-align:center>最多 90</td><td style=text-align:center>不为 0</td><td style=text-align:center>7</td><td style=text-align:center>7</td></tr></tbody></table></div><p>Linux 操作系统中的 /etc/login.defs 是登录程序的配置文件,在该文件中可以配置密码的过期天数、密码的长度约束等参数。如果 /etc/pam.d/system-auth 文件中有与该文件相同的选项，则以 /etc/pam.d/system-auth 文件的设置为准。/etc/pam.d/system-auth 文件的配置优先级高于 /etc/login.defs。</p><p>如果 /etc/shadow 文件里有相同的选项，则以 /etc/shadow 里的设置为准， /etc/shadow 的配置优先级高于 /etc/login.defs。</p><h2 id=etcpamdsystem-auth>/etc/pam.d/system-auth</h2><p>  本地登录失败处理功能相关参数。</p><div class=table-wrapper><table><thead><tr><th style=text-align:center>/</th><th style=text-align:center>deny=3</th><th style=text-align:center>unlock_time=60</th></tr></thead><tbody><tr><td style=text-align:center>字段含义</td><td style=text-align:center>输错密码 3 次后锁定当前用户</td><td style=text-align:center>锁定 60 秒</td></tr><tr><td style=text-align:center>等保要求</td><td style=text-align:center>deny=5</td><td style=text-align:center>unlock_time=300</td></tr></tbody></table></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>auth required pam_tally2.so deny=5 unlock_time=300 even_deny_root root_unlock_time=60     # 普通用户连续错误登录 5 次锁定 300 秒，root 用户连续错误登录 5 次锁定 60 秒
</span></span><span class=line><span class=cl>pam_tally2.so     # 是一个 linux 的用户登录计数器模块。他会维护用户尝试登录的次数，当登录成功时重置计数器，当尝试登录失败次数过多时阻止登录
</span></span></code></pre></td></tr></table></div></div><h2 id=etcprofile>/etc/profile</h2><p>  该文件中设置了超时锁定参数，等保要求在该文件中设置 <code>TMOUT=300</code>，意为 300 秒内无操作自动退出。</p><h2 id=etcsshsshd_config--grep--i-permitrootlogin>/etc/ssh/sshd_config | grep -i PermitRootLogin</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>PermitRootLogin yes     # 允许 root 账户登录，未限制其访问权限
</span></span></code></pre></td></tr></table></div></div><h2 id=sestatus>sestatus</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>SELinux=disabled     # SELinux 处于关闭模式（enabled 反之），未对重要主体和客体设置安全标记
</span></span><span class=line><span class=cl>SELinux=enforcing     # 已强制执行 SELinux 安全策略
</span></span></code></pre></td></tr></table></div></div><h2 id=service-rsyslog-status-或-systemctl-status-rsyslog>service rsyslog status 或 systemctl status rsyslog</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>active (running)      # 开启了系统日志服务，则 active (running) 为绿色
</span></span></code></pre></td></tr></table></div></div><h2 id=service-auditd-status-或-systemctl-status-auditd>service auditd status 或 systemctl status auditd</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>active (running)      # 开启了操作审计服务，则 active (running) 为绿色
</span></span></code></pre></td></tr></table></div></div><h2 id=auditctl--s>auditctl -s</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>enabled 1     # 开启了为 1，未开启为 0
</span></span></code></pre></td></tr></table></div></div><h2 id=auditctl--l>auditctl -l</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>No rules     # 未配置审计规则
</span></span></code></pre></td></tr></table></div></div><h2 id=cat-etcrsyslogconf>cat /etc/rsyslog.conf</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>/var/log/messages、/var/log/secure、/var/log/maillog 、/var/log/cron     # 审计记录
</span></span></code></pre></td></tr></table></div></div><h2 id=ls--l-varlog>ls -l /var/log</h2><blockquote><p>  配置文件权限不能大于 644，可执行文件不能大于 755。</p></blockquote><blockquote><p>  /var/log 下日志文件读写权限应不大于 600</p></blockquote><blockquote><p>  可执行权限只针对脚本和目录，对于一般文件没有什么作用。</p></blockquote><div class=table-wrapper><table><thead><tr><th style=text-align:center>权限</th><th style=text-align:center>英文缩写</th><th style=text-align:center>权限数字</th></tr></thead><tbody><tr><td style=text-align:center>读</td><td style=text-align:center>r</td><td style=text-align:center>4</td></tr><tr><td style=text-align:center>写</td><td style=text-align:center>w</td><td style=text-align:center>2</td></tr><tr><td style=text-align:center>执行</td><td style=text-align:center>x</td><td style=text-align:center>1</td></tr><tr><td style=text-align:center>空</td><td style=text-align:center>-</td><td style=text-align:center>0</td></tr></tbody></table></div><p>  查看该文件权限为：rwxrw-r&ndash;，对应了三种不同用户的权限。</p><div class=table-wrapper><table><thead><tr><th style=text-align:center>权限缩写</th><th style=text-align:center>rwx</th><th style=text-align:center>rw-</th><th style=text-align:center>r&ndash;</th></tr></thead><tbody><tr><td style=text-align:center>权限数字</td><td style=text-align:center>7</td><td style=text-align:center>6</td><td style=text-align:center>4</td></tr><tr><td style=text-align:center>对应权限</td><td style=text-align:center>可读可写可执行</td><td style=text-align:center>可读可写</td><td style=text-align:center>只读</td></tr><tr><td style=text-align:center>适用用户</td><td style=text-align:center>当前文件的拥有者的权限</td><td style=text-align:center>当前文件的所属组权限</td><td style=text-align:center>当前文件的组外权限</td></tr><tr><td style=text-align:center>我的理解</td><td style=text-align:center>文件拥有者</td><td style=text-align:center>文件拥有者所属组用户</td><td style=text-align:center>其余用户</td></tr></tbody></table></div><h2 id=service-sshd-status-或-ps--e--grep-sshd>service sshd status 或 ps -e | grep sshd</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>active (running)      # 运行了 sshd 服务，则 active (running) 为绿色
</span></span><span class=line><span class=cl>ssh-agent     # 若没有启动 server 可以手动开启：sudo /etc/init.d/ssh start
</span></span><span class=line><span class=cl>1041 ? 00:00:06 sshd     # sshd 服务正常运行中
</span></span></code></pre></td></tr></table></div></div><h2 id=systemctl-status-telnetsocket>systemctl status telnet.socket</h2><p>  若未使用 SSH 协议进行远程管理，则查看是否使用 telnet 协议进行远程管理。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>active (running)      # 若运行了 telent 服务，则 active (running) 为绿色
</span></span></code></pre></td></tr></table></div></div><h2 id=systemctl-list-unit-files>systemctl list-unit-files</h2><p>  多余的服务：Alerter、RemoteRegistry Service Messenger、Task Scheduler。</p><div class=table-wrapper><table><thead><tr><th style=text-align:center>状态</th><th style=text-align:center>颜色</th><th style=text-align:center>解释</th></tr></thead><tbody><tr><td style=text-align:center>enable</td><td style=text-align:center>绿色</td><td style=text-align:center>运行的服务</td></tr><tr><td style=text-align:center>static</td><td style=text-align:center>白色</td><td style=text-align:center>静默的服务</td></tr><tr><td style=text-align:center>disable</td><td style=text-align:center>红色</td><td style=text-align:center>禁止运行的服务</td></tr></tbody></table></div><h2 id=netstat--an-或-netstat--ntlp>netstat -an 或 netstat -ntlp</h2><div class=table-wrapper><table><thead><tr><th style=text-align:center>协议</th><th style=text-align:center>高危端口</th><th style=text-align:center>流行病毒的后门端口</th></tr></thead><tbody><tr><td style=text-align:center>TCP</td><td style=text-align:center>135、139、445、593、1025</td><td style=text-align:center>2745、3127、6129</td></tr><tr><td style=text-align:center>UDP</td><td style=text-align:center>135、137、138、445</td><td></td></tr></tbody></table></div><h2 id=rpm--qi-samba>rpm -qi samba</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>samba</span> <span class=nx>is</span> <span class=nx>not</span> <span class=nx>installed</span>     <span class=err>#</span> <span class=nx>未安装则不存在默认共享</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=cat-etchostsallow>cat /etc/hosts.allow</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sshd:10.10.22.21:allow     # 允许 IP 地址 10.10.22.21 通过 SSH 访问服务器
</span></span></code></pre></td></tr></table></div></div><h2 id=cat-etchostsdeny>cat /etc/hosts.deny</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>ALL: ALL     # 拒绝所有请求
</span></span></code></pre></td></tr></table></div></div></section><footer class=article-footer><section class=article-tags><a href=/tags/linux/>Linux</a>
<a href=/tags/%E6%B5%8B%E8%AF%84/>测评</a>
<a href=/tags/%E5%91%BD%E4%BB%A4/>命令</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-ND 4.0</span></section><section class=article-lastmod><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><span>最后更新于 Aug 07, 2022 16:37 +0800</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>相关文章</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E5%88%B6%E5%BA%A6%E4%BD%93%E7%B3%BB/><div class=article-details><h2 class=article-title>安全管理制度体系</h2></div></a></article><article><a href=/gb/t-28448-2019/><div class=article-details><h2 class=article-title>GB/T 28448-2019</h2></div></a></article><article><a href=/osi%E4%B8%83%E5%B1%82%E6%A8%A1%E5%9E%8B/><div class=article-details><h2 class=article-title>OSI七层模型</h2></div></a></article><article><a href=/tcp%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%92%8C%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B/><div class=article-details><h2 class=article-title>TCP三次握手和四次挥手</h2></div></a></article><article><a href=/%E7%AD%89%E4%BF%9D2.0%E6%A0%87%E5%87%86%E6%9C%AF%E8%AF%AD/><div class=article-details><h2 class=article-title>等保2.0标准术语</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2022 Rainbow</section><section class=powerby><a href=https://www.foreverblog.cn/go.html target=_blank><img src=https://img.foreverblog.cn/wormhole_3_tp.gif alt style=width:auto;height:32px title=穿梭虫洞-随机访问十年之约友链博客></a></br><script>!function(e){"use strict";!function(){var i,s=window,o=document,a=e,c="".concat("https:"===o.location.protocol?"https://":"http://","sdk.51.la/js-sdk-pro.min.js"),n=o.createElement("script"),r=o.getElementsByTagName("script")[0];n.type="text/javascript",n.setAttribute("charset","UTF-8"),n.async=!0,n.src=c,n.id="LA_COLLECT",a.d=n,i=function(){s.LA.ids.push(a)},s.LA?s.LA.ids&&i():(s.LA=e,s.LA.ids=[],i()),r.parentNode.insertBefore(n,r)}()}({id:"Jgb8aUbG5e3rqhrs",ck:"Jgb8aUbG5e3rqhrs",autoTrack:!0,hashMode:!0})</script><script id=LA-DATA-WIDGET crossorigin=anonymous src="https://v6-widget.51.la/v6/Jgb8aUbG5e3rqhrs/quote.js?theme=0&f=12"></script></br><div><span id=timeDate>载入年天数...</span><span id=times>载入时分秒...</span><script async src=/js/duration.js></script></br><a href=https://beian.miit.gov.cn/ target=_blank style=float:left>苏ICP备2022013807号</a><a target=_blank href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=32050802011527"><img src=/images/备案图标.png style=float:left>苏公网安备 32050802011527号</a><br>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>主题 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.12.0>Stack</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 设计</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目录</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#测评命令汇总>测评命令汇总</a></li><li><a href=#lscpu>lscpu</a></li><li><a href=#etcredhat-release>/etc/redhat-release</a></li><li><a href=#ifconfig>ifconfig</a></li><li><a href=#ps--ef--grep-nginx>ps -ef | grep nginx</a></li><li><a href=#etcshadow>/etc/shadow</a></li><li><a href=#etcpasswd>/etc/passwd</a></li><li><a href=#etclogindefs>/etc/login.defs</a></li><li><a href=#etcpamdsystem-auth>/etc/pam.d/system-auth</a></li><li><a href=#etcprofile>/etc/profile</a></li><li><a href=#etcsshsshd_config--grep--i-permitrootlogin>/etc/ssh/sshd_config | grep -i PermitRootLogin</a></li><li><a href=#sestatus>sestatus</a></li><li><a href=#service-rsyslog-status-或-systemctl-status-rsyslog>service rsyslog status 或 systemctl status rsyslog</a></li><li><a href=#service-auditd-status-或-systemctl-status-auditd>service auditd status 或 systemctl status auditd</a></li><li><a href=#auditctl--s>auditctl -s</a></li><li><a href=#auditctl--l>auditctl -l</a></li><li><a href=#cat-etcrsyslogconf>cat /etc/rsyslog.conf</a></li><li><a href=#ls--l-varlog>ls -l /var/log</a></li><li><a href=#service-sshd-status-或-ps--e--grep-sshd>service sshd status 或 ps -e | grep sshd</a></li><li><a href=#systemctl-status-telnetsocket>systemctl status telnet.socket</a></li><li><a href=#systemctl-list-unit-files>systemctl list-unit-files</a></li><li><a href=#netstat--an-或-netstat--ntlp>netstat -an 或 netstat -ntlp</a></li><li><a href=#rpm--qi-samba>rpm -qi samba</a></li><li><a href=#cat-etchostsallow>cat /etc/hosts.allow</a></li><li><a href=#cat-etchostsdeny>cat /etc/hosts.deny</a></li></ol></nav></div></section></aside></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>